<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>NAS（6）—— SMB &amp; WebDAV | Dean's Blog</title><meta name="author" content="Dean Ma"><meta name="copyright" content="Dean Ma"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="回到目录  概述 经过前面几个模块的配置，我们已经能够在 NAS 上存放我们的数据，并且通过组建 RAID 与接入 UPS 等方式加强了数据存储的安全性。在这个部分，我们需要通过配置来实现通过各种设备来访问 NAS 中存储的数据，并且进一步加强数据存储的安全性。 SMB &#x2F; Samba SMB（Server Message Block）可用于在计算机间共享文件、打印机、串口等，电脑上的网上邻居就是">
<meta property="og:type" content="article">
<meta property="og:title" content="NAS（6）—— SMB &amp; WebDAV">
<meta property="og:url" content="https://blog.dawnocean.site/NAS-6">
<meta property="og:site_name" content="Dean&#39;s Blog">
<meta property="og:description" content="回到目录  概述 经过前面几个模块的配置，我们已经能够在 NAS 上存放我们的数据，并且通过组建 RAID 与接入 UPS 等方式加强了数据存储的安全性。在这个部分，我们需要通过配置来实现通过各种设备来访问 NAS 中存储的数据，并且进一步加强数据存储的安全性。 SMB &#x2F; Samba SMB（Server Message Block）可用于在计算机间共享文件、打印机、串口等，电脑上的网上邻居就是">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://blog.dawnocean.site/assets/img/default_cover3.JPEG">
<meta property="article:published_time" content="2024-08-25T18:43:35.000Z">
<meta property="article:modified_time" content="2025-09-02T17:33:35.538Z">
<meta property="article:author" content="Dean Ma">
<meta property="article:tag" content="SMB">
<meta property="article:tag" content="WebDAV">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://blog.dawnocean.site/assets/img/default_cover3.JPEG"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "NAS（6）—— SMB & WebDAV",
  "url": "https://blog.dawnocean.site/NAS-6",
  "image": "https://blog.dawnocean.site/assets/img/default_cover3.JPEG",
  "datePublished": "2024-08-25T18:43:35.000Z",
  "dateModified": "2025-09-02T17:33:35.538Z",
  "author": [
    {
      "@type": "Person",
      "name": "Dean Ma",
      "url": "https://blog.dawnocean.site"
    }
  ]
}</script><link rel="shortcut icon" href="/assets/img/avatar.jpg"><link rel="canonical" href="https://blog.dawnocean.site/NAS-6"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="baidu-site-verification" content="codeva-GQcRECGqLJ"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":50,"languages":{"author":"作者: Dean Ma","link":"链接: ","source":"来源: Dean's Blog","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'NAS（6）—— SMB & WebDAV',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"><link href="https://cdn.bootcss.com/KaTeX/0.11.1/katex.min.css" rel="stylesheet" /></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><script>(()=>{
  const $loadingBox = document.getElementById('loading-box')
  const $body = document.body
  const preloader = {
    endLoading: () => {
      if ($loadingBox.classList.contains('loaded')) return
      $body.style.overflow = ''
      $loadingBox.classList.add('loaded')
    },
    initLoading: () => {
      $body.style.overflow = 'hidden'
      $loadingBox.classList.remove('loaded')
    }
  }

  preloader.initLoading()

  if (document.readyState === 'complete') {
    preloader.endLoading()
  } else {
    window.addEventListener('load', preloader.endLoading)
    document.addEventListener('DOMContentLoaded', preloader.endLoading)
    // Add timeout protection: force end after 7 seconds
    setTimeout(preloader.endLoading, 7000)
  }

  if (false) {
    btf.addGlobalFn('pjaxSend', preloader.initLoading, 'preloader_init')
    btf.addGlobalFn('pjaxComplete', preloader.endLoading, 'preloader_end')
  }
})()</script><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/assets/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">39</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">36</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">27</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-compass"></i><span> 页面</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li><li><a class="site-page child" href="/shuoshuo/"><i class="fa-fw fas fa-comments"></i><span> 说说</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-book"></i><span> 文章</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/NAS-Router-0"><i class="fa-fw fas fa-computer"></i><span> 硬路由 / NAS</span></a></li><li><a class="site-page child" href="/Furry-1"><i class="fa-fw fas fa-paw"></i><span> Furry 杂谈</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/assets/img/default_cover3.JPEG);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><img class="site-icon" src="/assets/img/avatar.jpg" alt="Logo"><span class="site-name">Dean's Blog</span></a><a class="nav-page-title" href="/"><span class="site-name">NAS（6）—— SMB &amp; WebDAV</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  返回首页</span></span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-compass"></i><span> 页面</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li><li><a class="site-page child" href="/shuoshuo/"><i class="fa-fw fas fa-comments"></i><span> 说说</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-book"></i><span> 文章</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/NAS-Router-0"><i class="fa-fw fas fa-computer"></i><span> 硬路由 / NAS</span></a></li><li><a class="site-page child" href="/Furry-1"><i class="fa-fw fas fa-paw"></i><span> Furry 杂谈</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">NAS（6）—— SMB &amp; WebDAV</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-08-25T18:43:35.000Z" title="发表于 2024-08-26 02:43:35">2024-08-26</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-09-02T17:33:35.538Z" title="更新于 2025-09-03 01:33:35">2025-09-03</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/NAS/">NAS</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><link rel="stylesheet external nofollow noreferrer" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><a href="/NAS-Router-0" title="NAS &#x2F; 硬路由：从入门到入门">回到目录</a>
<br/>
<h1 id="概述"><a class="header-anchor" href="#概述"></a>概述</h1>
<p>经过前面几个模块的配置，我们已经能够在 NAS 上存放我们的数据，并且通过组建 RAID 与接入 UPS 等方式加强了数据存储的安全性。在这个部分，我们需要通过配置来实现通过各种设备来访问 NAS 中存储的数据，并且进一步加强数据存储的安全性。</p>
<h2 id="smb-samba"><a class="header-anchor" href="#smb-samba"></a>SMB / Samba</h2>
<p>SMB（Server Message Block）可用于在计算机间共享文件、打印机、串口等，电脑上的网上邻居就是靠它实现的。通过 SMB 协议，客户端应用程序可以在各种网络环境下读、写服务器上的文件，以及对服务器程序提出服务请求。此外通过 SMB 协议，应用程序可以访问远程服务器端的文件、以及打印机等资源。</p>
<p>Samba 能让 Linux 服务器实现文件服务器、身份授权和认证、名称解析和打印服务等功能。</p>
<p>Samba 也是 SMB 协议的实现，它允许 Windows 客户访问 Linux 系统上的目录、打印机和文件（就像访问 Windows 服务器时一样）。重要的是，Samba 可以将 Linux 服务器构建成一个域控制器。这样一来，就可以直接使用 Windows 域中的用户凭据，免去手动在 Linux 服务器上重新创建的麻烦。</p>
<p>相比于 NFS，SMB / Samba 对 Windows 系统有着更好的支持，兼容性更优。</p>
<p>但非常值得一提的是，SMB 协议本身是面向局域网连接的，尤其是 SMB1.0/CIFS 协议，它仍使用的 NetBIOS 协议（139 端口）存在很多安全漏洞。并且由于 Wannacry 勒索病毒利用永恒之蓝漏洞造成了巨大威胁，SMB1.0/CIFS 已经逐渐被弃用。即使是后续的 SMBv2 以及 SMBv3，也被报告过 CVE（Common Vulnerabilities and Exposures，公共漏洞和暴露），因此建议<strong>不要在公网使用 SMB 服务</strong>。</p>
<p>如果需要远程文件管理，可以使用 Tailscale 等方案搭建虚拟局域网，或者通过更安全的文件传输协议，如 WebDAV 等。</p>
<h2 id="异地容灾"><a class="header-anchor" href="#异地容灾"></a>异地容灾</h2>
<p>在数据存储与容灾方面，有一条重要的原则，3-2-1 原则：</p>
<ul>
<li><strong>3</strong>：同一数据至少保存 <strong>3</strong> 份，包括原数据；</li>
<li><strong>2</strong>：保存到 <strong>2</strong> 种以上存储介质上，如机械硬盘 / 固态硬盘；</li>
<li><strong>1</strong>：至少有 <strong>1</strong> 份异地备份，防止本地发生灾难时数据完全丢失，如选择保存到云服务器上。</li>
</ul>
<h1 id="smb-配置"><a class="header-anchor" href="#smb-配置"></a>SMB 配置</h1>
<h2 id="nas-端-45drive-s-file-sharing"><a class="header-anchor" href="#nas-端-45drive-s-file-sharing"></a>NAS 端 —— 45Drive’s File Sharing</h2>
<p>首先确保安装了 45Drive’s 库的 File Sharing 包。</p>
<p>在 Cockpit 控制台中<code>File Sharing - Shares</code>处添加 SMB 共享：</p>
<p><img src="NAS-6/image_pW-C22fE2_.png" alt=""></p>
<p>按照下图进行配置即可。</p>
<p><img src="NAS-6/image1.png" alt=""></p>
<p>需要共享多个文件夹，就在 Shares 处创建多个共享配置。</p>
<p>为了让其他设备具有写入权限，请配置共享文件夹的权限为 744。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> <span class="built_in">chmod</span> 744 -R /dir</span><br></pre></td></tr></table></figure>
<p>在配置了 IPv6 后，我们的 SMB 服务相当于<strong>暴露在公网中</strong>，因此更应做好访问控制。建议在路由器上关闭 IPv6 的 139 与 445 端口。</p>
<p>Samba 有自己的用户系统，但与系统用户名一致的用户拥有相同的访问权限。</p>
<p>我们创建一个与当前用户一致的 Samba 用户：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> smbpasswd -a &lt;你正在使用的用户名&gt;</span><br></pre></td></tr></table></figure>
<p>根据提示设置好密码后（请设置高强度密码），修改共享文件夹及其文件的拥有者以匹配 Samba 用户：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> <span class="built_in">chown</span> &lt;你正在使用的用户名&gt;:&lt;所在用户组&gt; -R /dir</span><br></pre></td></tr></table></figure>
<p>在 Cockpit 中的防火墙放行 TCP 445 端口的请求。</p>
<h2 id="其他设备端"><a class="header-anchor" href="#其他设备端"></a>其他设备端</h2>
<p>对于 Windows 系统，确认其已连接到 NAS 的局域网中。打开运行，输入<code>\\&lt;NAS IP&gt;</code>，回车：</p>
<p><img src="NAS-6/image_pkBmWbVj-b.png" alt=""></p>
<p>访问对应文件夹，确认能够正常读写其中的文件。</p>
<p><img src="NAS-6/image_Zucjtsg4JD.png" alt=""></p>
<p>可以将文件夹映射到驱动器，便于访问。右键文件夹，选择映射网络驱动器：</p>
<p><img src="NAS-6/image_oA0kP8OPt4.png" alt=""></p>
<p>指定驱动器号，即可在此电脑中看到对应文件夹。</p>
<p><img src="NAS-6/image_uca3CXn-Gf.png" alt=""></p>
<h1 id="webdav"><a class="header-anchor" href="#webdav"></a>WebDAV</h1>
<p>随着云计算和移动互联网的快速发展，远程访问、编辑和共享文件的需求日益增强。为了满足这一需求，WebDAV（Web-based Distributed Authoring and Versioning）应运而生，成为了一种基于 HTTP 协议的通信协议，扩展了 HTTP 1.1，提供了应用程序直接对 Web 服务器进行读写操作的能力。</p>
<h2 id="自建-webdav-服务"><a class="header-anchor" href="#自建-webdav-服务"></a>自建 WebDAV 服务</h2>
<p>如果你恰好有一台云服务器，并且带宽足够，连接稳定，就可以在上面部署 WebDAV 服务。我们也可以在 NAS 上部署 WebDAV 服务，来实现安全的远程文件访问。远程访问时，请为 WebDAV 配置 HTTPS。</p>
<h3 id="绑定挂载"><a class="header-anchor" href="#绑定挂载"></a>绑定挂载</h3>
<p>如果我们希望将多个不在同一目录下的不同目录都挂载到 WebDAV，我们可以采用绑定挂载（Bind mount）的方式。绑定挂载是 Linux 提供的一种特殊挂载方式，它可以让一个已有的目录在另一个路径下“出现”。</p>
<p>新建一个用于 WebDAV 访问的目录：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> <span class="built_in">mkdir</span> -p /path/to/webdav/root       <span class="comment"># 创建总根目录</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">sudo</span> <span class="built_in">mkdir</span> -p /path/to/webdav/root/data1 <span class="comment"># 创建用于挂载数据目录的子目录</span></span><br><span class="line"><span class="built_in">sudo</span> <span class="built_in">mkdir</span> -p /path/to/webdav/root/data2</span><br></pre></td></tr></table></figure>
<p>进行绑定挂载：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> mount --<span class="built_in">bind</span> /path/to/your/data1 /path/to/webdav/root/data1</span><br><span class="line"><span class="built_in">sudo</span> mount --<span class="built_in">bind</span> /path/to/your/data2 /path/to/webdav/root/data2</span><br></pre></td></tr></table></figure>
<p>可通过 <code>ls</code> 命令查看是否成功挂载。确认成功后，将挂载配置写入 <code>/etc/fstab</code> 文件中，实现开机自动挂载：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> vim /etc/fstab</span><br></pre></td></tr></table></figure>
<p>将以下内容添加到文件末尾：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># WebDAV Bind Mounts</span><br><span class="line">/path/to/your/data1     /path/to/webdav/root/data1   none   bind   0   0</span><br><span class="line">/path/to/your/data2     /path/to/webdav/root/data2   none   bind   0   0</span><br></pre></td></tr></table></figure>
<p>保存后，运行 <code>sudo mount -a</code> 来测试 fstab 配置是否正确。</p>
<h3 id="caddy-webdav"><a class="header-anchor" href="#caddy-webdav"></a>Caddy WebDAV</h3>
<p>关于 Caddy 的介绍，详见 <a href="/NAS-8" title="NAS（8）—— 反向代理 &amp; HTTPS">反向代理 &amp; HTTPS</a>。</p>
<h4 id="安装-webdav-插件"><a class="header-anchor" href="#安装-webdav-插件"></a>安装 WebDAV 插件</h4>
<p>为了在 Caddy 上开启 WebDAV 服务，我们需要先安装 <code>mholt/caddy-webdav</code> 插件：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> caddy add-package github.com/mholt/caddy-webdav</span><br></pre></td></tr></table></figure>
<p>安装完成后，重启 Caddy：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> systemctl restart caddy</span><br></pre></td></tr></table></figure>
<h4 id="webdav-配置"><a class="header-anchor" href="#webdav-配置"></a>WebDAV 配置</h4>
<p>接下来编辑 Caddy 配置，搭建 WebDAV 服务：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> vim /etc/caddy/Caddyfile</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    order webdav before file_server  # 这一部分配置放在文件开头</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">nas.dawnocean.site:6666 &#123;    # WebDAV 服务端口</span><br><span class="line">    rewrite /dav /dav/       # WebDAV 根路径，即以 https://xxx.xx:6666/dav 访问</span><br><span class="line">    basicauth &#123;</span><br><span class="line">       test $2a$14$xxx.xxxx  # bcrypt，使用 caddy hash-password 命令生成</span><br><span class="line">    &#125;</span><br><span class="line">    webdav /dav/* &#123;          # 与 WebDAV 根路径一致</span><br><span class="line">        root /mnt/webdav     # 实际待访问的路径</span><br><span class="line">        prefix /dav          # 与 WebDAV 根路径一致</span><br><span class="line">    &#125;</span><br><span class="line">    request_body &#123;</span><br><span class="line">        max_size 50000MB     # 大文件上传限制</span><br><span class="line">    &#125;</span><br><span class="line">    log &#123;                    # 日志上传配置，请确保 caddy 用户具有读写权限</span><br><span class="line">        output file /etc/caddy/caddy.log &#123;</span><br><span class="line">            roll_local_time</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    tls /path/to/your/cert /path/to/your/key # SSL 证书配置，远程访问建议启用</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="caddy-权限配置"><a class="header-anchor" href="#caddy-权限配置"></a>Caddy 权限配置</h4>
<p>如果 Caddy 通过 systemd 运行，需要额外编辑 service 配置以确保 Caddy 具有读写权限：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> systemctl edit caddy.service</span><br></pre></td></tr></table></figure>
<p>在打开的编辑器中，添加以下内容：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[Service]</span><br><span class="line">ReadWriteDirectories=/path/to/your/data /path/to/config/dir  # 多个路径以空格分割</span><br></pre></td></tr></table></figure>
<p>完成编辑后，重新加载 systemd 并重启 Caddy：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> systemctl daemon-reload</span><br><span class="line"><span class="built_in">sudo</span> systemctl restart caddy</span><br></pre></td></tr></table></figure>
<p>由于 Caddy 在运行时是通过 caddy 用户来操作，因此我们需要确保 caddy 用户至少对于数据文件具有读写权限，对于目录具有读写执行（进入）权限。</p>
<p>假设数据目录由 <code>test:test</code> 用户及用户组所有，我们希望保持数据的归属权：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> <span class="built_in">chmod</span> 775 -R /path/to/your/data</span><br><span class="line"><span class="built_in">sudo</span> usermod -aG <span class="built_in">test</span> caddy            <span class="comment"># 将 Caddy 用户加入 test 用户组</span></span><br></pre></td></tr></table></figure>
<h3 id="standalone-webdav-不推荐-基于-hacdias-webdav"><a class="header-anchor" href="#standalone-webdav-不推荐-基于-hacdias-webdav"></a>Standalone WebDAV（不推荐，基于 hacdias/webdav）</h3>
<p>我们采用 Go 语言实现的 <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/hacdias/webdav" title="Standalone WebDAV">Standalone WebDAV</a> 服务。但经过笔者实测，在面对大文件读写时，该方案可能会出现<strong>内存溢出以及卡顿</strong>的问题，因此不推荐使用。</p>
<p>我们使用 Docker Compose 部署。关于 Docker 的介绍，详见 <a href="/NAS-7" title="NAS（7）—— Docker 服务">Docker 服务</a>。</p>
<p>先在文件夹下创建配置文件：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> vim config.yml</span><br></pre></td></tr></table></figure>
<p>输入以下内容，根据具体情况进行修改：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">address:</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span></span><br><span class="line"><span class="attr">port:</span> <span class="number">6060</span> <span class="comment"># 端口自定，记得在防火墙当中放行</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 是否配置 HTTPS，若更改为 true，请对应更改 cert 以及 key 地址</span></span><br><span class="line"><span class="attr">tls:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">cert:</span> <span class="string">cert.pem</span></span><br><span class="line"><span class="attr">key:</span> <span class="string">key.pem</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># WebDAV 访问前缀路径。默认为 &#x27;/&#x27;</span></span><br><span class="line"><span class="attr">prefix:</span> <span class="string">/</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 用户的默认权限。可选择 CRUD（Create, Read, Update, Delete）</span></span><br><span class="line"><span class="attr">permissions:</span> <span class="string">R</span></span><br><span class="line"></span><br><span class="line"><span class="attr">rules:</span> []</span><br><span class="line"></span><br><span class="line"><span class="comment"># CORS 跨域请求配置</span></span><br><span class="line"><span class="attr">cors:</span></span><br><span class="line">  <span class="attr">enabled:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">credentials:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">allowed_headers:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">Depth</span></span><br><span class="line">  <span class="attr">allowed_hosts:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">http://localhost:8080</span></span><br><span class="line">  <span class="attr">allowed_methods:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">GET</span></span><br><span class="line">  <span class="attr">exposed_headers:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">Content-Length</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">Content-Range</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 建议以 user 的形式单独配置权限以及文件夹位置</span></span><br><span class="line"><span class="attr">users:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">username:</span> <span class="string">test</span></span><br><span class="line">    <span class="attr">password:</span> <span class="string">&quot;&#123;bcrypt&#125;$2a$10xxxxx.xxxxxxx&quot;</span></span><br><span class="line">    <span class="attr">permissions:</span> <span class="string">CRUD</span></span><br></pre></td></tr></table></figure>
<p>继续创建 <code>docker-compose.yml</code> 文件：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">webdav:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">ghcr.io/hacdias/webdav</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;6060:6060&quot;</span> <span class="comment"># 端口自定，记得在防火墙当中放行</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./config.yml:/config.yml:ro</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/path/to/your/data:/data</span></span><br><span class="line">    <span class="attr">command:</span> <span class="string">&quot;-c /config.yml&quot;</span></span><br><span class="line">    <span class="attr">logging:</span></span><br><span class="line">      <span class="attr">driver:</span> <span class="string">journald</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">unless-stopped</span></span><br></pre></td></tr></table></figure>
<h2 id="webdav-服务商"><a class="header-anchor" href="#webdav-服务商"></a>WebDAV 服务商</h2>
<p>目前国内支持 WebDAV 的云盘服务商只有坚果云。不过，阿里云盘通过开放平台接口可以实现 WebDAV 服务。这里是<a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/messense/aliyundrive-webdav" title="项目地址">项目地址</a>。</p>
<p>坚果云对于免费用户每月提供 1GB 的上传流量以及 3GB 的下载流量。可以在第三方应用管理处创建应用密码。</p>
<p><img src="NAS-6/image_pFn_muetp9.png" alt=""></p>
<h2 id="挂载-webdav-为本地磁盘"><a class="header-anchor" href="#挂载-webdav-为本地磁盘"></a>挂载 WebDAV 为本地磁盘</h2>
<h3 id="自动挂载"><a class="header-anchor" href="#自动挂载"></a>自动挂载</h3>
<p>各平台都有较为好用的 WebDAV 图形化客户端，如 Windows 端的 RaiDrive，Linux 端的 Dolphin / Thunar，macOS 端的 Finder（虽然 Finder 可能会出现卡顿问题）。根据软件里的指示进行挂载与登录即可。</p>
<p>当然，也有一些较为方便的命令行自动挂载工具，如 cadaver，rclone 等。</p>
<h3 id="命令行手动挂载-davfs2"><a class="header-anchor" href="#命令行手动挂载-davfs2"></a>命令行手动挂载- davfs2</h3>
<p>以下部分来自于<a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.dujin.org/17037.html" title="这篇文章">这篇文章</a>。</p>
<h4 id="安装"><a class="header-anchor" href="#安装"></a>安装</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> apt install davfs2</span><br></pre></td></tr></table></figure>
<h4 id="挂载-webdav-磁盘"><a class="header-anchor" href="#挂载-webdav-磁盘"></a>挂载 WebDAV 磁盘</h4>
<p>先在 Linux 系统上创建要挂载的文件目录，名称自定：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> /Aliyun</span><br></pre></td></tr></table></figure>
<p>挂载远端 WebDAV 至本地的<code>/Aliyun</code>目录下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mount -t davfs http(s)://&lt;服务器地址/域名&gt;:&lt;端口&gt;/ /Aliyun <span class="comment"># 请根据实际情况配置</span></span><br></pre></td></tr></table></figure>
<p>回车后输入自己的用户名和密码，完成。可以输入<code>df -h</code>指令来查看是否成功。</p>
<p><img src="NAS-6/image_QBMxoN8z84.png" alt=""></p>
<h4 id="挂载坚果云-webdav"><a class="header-anchor" href="#挂载坚果云-webdav"></a>挂载坚果云 WebDAV</h4>
<p>如果使用上述方法挂载坚果云 WebDAV，会出现如下报错信息：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/sbin/mount.davfs: mounting failed; the server does not support WebDAV</span><br></pre></td></tr></table></figure>
<p>出现此情况的原因是，mount.davfs 命令在挂载时和 WebDAV 服务器建立连接，并通过 libneon 库的 <code>ne_options()</code> 函数发送 HTTP OPTIONS 请求获取 WebDAV 服务器能力，虽然返回成功但判断坚果云 WebDAV 服务器不支持 Class 1 WebDAV，因此直接报错挂载失败。</p>
<p>解决办法：修改<code>/etc/davfs2/davfs2.conf</code>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> vim /etc/davfs2/davfs2.conf</span><br></pre></td></tr></table></figure>
<p>将 <code>ignore_dav_header</code> 取消注释，并将 0 改为 1，保存并退出。</p>
<p>再次挂载，成功。</p>
<h4 id="开机自动挂载-webdav"><a class="header-anchor" href="#开机自动挂载-webdav"></a>开机自动挂载 WebDAV</h4>
<h5 id="启用-davfs2-用户锁"><a class="header-anchor" href="#启用-davfs2-用户锁"></a>启用 davfs2 用户锁</h5>
<p>编辑<code>/etc/davfs2/davfs2.conf</code>文件：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> vim /etc/davfs2/davfs2.conf</span><br></pre></td></tr></table></figure>
<p>将 <code>use_locks</code> 取消注释，并将 1 改为 0，保存并退出。</p>
<h5 id="记住-webdav-账号密码"><a class="header-anchor" href="#记住-webdav-账号密码"></a>记住 WebDAV 账号密码</h5>
<p>编辑<code>/etc/davfs2/secrets</code>文件：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> vim /etc/davfs2/secrets</span><br></pre></td></tr></table></figure>
<p>在末尾增加一行内容：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http(s)://&lt;服务器地址/域名&gt;:&lt;端口&gt;/ &lt;username&gt; &lt;password&gt;</span><br></pre></td></tr></table></figure>
<p>这里的 username 和 password 请更改为 webdav.yaml 中对应的用户名和密码。</p>
<h5 id="开机执行挂载"><a class="header-anchor" href="#开机执行挂载"></a>开机执行挂载</h5>
<p>编辑<code>/etc/rc.local</code>文件：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> vim /etc/rc.local</span><br></pre></td></tr></table></figure>
<p>文件末尾加上挂载指令，与上文一致。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mount -t davfs http(s)://&lt;服务器地址/域名&gt;:&lt;端口&gt;/ /Aliyun <span class="comment"># 请根据实际情况配置</span></span><br></pre></td></tr></table></figure>
<p>保存退出即可。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://blog.dawnocean.site">Dean Ma</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://blog.dawnocean.site/NAS-6">https://blog.dawnocean.site/NAS-6</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow noreferrer" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://blog.dawnocean.site" target="_blank">Dean's Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/SMB/">SMB</a><a class="post-meta__tags" href="/tags/WebDAV/">WebDAV</a></div><div class="post-share"><div class="social-share" data-image="/assets/img/default_cover3.JPEG" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/NAS-7" title="NAS（7）—— Docker 服务"><img class="cover" src="/assets/img/kirby_cover19.JPG" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">NAS（7）—— Docker 服务</div></div><div class="info-2"><div class="info-item-1">回到目录  概述 恭喜你读到了这里！如果你按照前面几篇文章配置下来，那么你的 NAS 已经可以应对各种数据存储需求了。接下来，我们要让 NAS 行使作为一台服务器的功能了。 Docker 是一个开源的应用容器引擎，基于 Go 语言 并遵从 Apache 2.0 协议开源。 Docker 可以让开发者打包他们的应用以及依赖包到一个轻量级、可移植的容器中，然后发布到任何流行的 Linux 机器上，也可以实现虚拟化。 容器完全使用沙箱机制，相互之间不会有任何接口，更重要的是容器性能开销极低。 如果有条件，请务必为你的 NAS 配置科学上网服务，可以使用部署在 OpenWrt 上等方法。由于国内镜像源不全面等原因，部分镜像在拉取时很容易出现超时的问题。尤其是 Docker 的安装过程，在没有代理的情况下很难完成。 Docker 架构   守护进程 (Docker daemon)：负责管理镜像、容器、容器网络、数据卷等。 Client：负责发送 Docker 操作指令，日常主要通过 Client 完成镜像和容器的管理。 镜像 (Image)：即容器的模版，镜像是可以继承的，镜像主要通过 D...</div></div></div></a><a class="pagination-related" href="/NAS-5" title="NAS（5）—— 数据冗余保障"><img class="cover" src="/assets/img/kirby_cover20.JPG" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">NAS（5）—— 数据冗余保障</div></div><div class="info-2"><div class="info-item-1">回到目录  硬盘健康监测 SMART S.M.A.R.T. 代表的是 Self-Monitoring Analysis and Reporting Technology，意思是自我检测、分析及报告技术。可以用来预测和分析硬盘的潜在问题。 对于机械硬盘（HDD）的寿命信息，我们主要关注这几个条目：  重新分配扇区系数（05） 当前等待中扇区数（C5） 无法修正的扇区总数（C6，重要，不为零即建议备份数据、换盘）  对于固态硬盘（SSD）的寿命信息，我们主要关注这几个条目：  可用备用空间（03） 已用寿命百分比（05） 媒体与数据完整性错误计数（0E，重要，不为零即建议备份数据、换盘）  在 Windows 系统，我们可以使用 CrystalDiskInfo 这款软件来查看硬盘的 Smart 信息。 在 Linux 系统，我们可以使用smartmontools包来查看硬盘的 Smart 信息。 1sudo apt install smartmontools -y 要确保您的驱动器支持 SMART，请键入： 1sudo smartctl -i /dev/sda 其中/dev/sda一...</div></div></div></a></nav><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="giscus-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/assets/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Dean Ma</div><div class="author-info-description">晓洋的博客</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">39</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">36</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">27</div></a></div><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/Dawn1Ocean" rel="external nofollow noreferrer" target="_blank" title="Github"><i class="fab fa-github" style="color: #000000;"></i></a><a class="social-icon" href="mailto:dawn_ocean@qq.com" rel="external nofollow noreferrer" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #000000;"></i></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%A6%82%E8%BF%B0"><span class="toc-number">1.</span> <span class="toc-text">概述</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#smb-samba"><span class="toc-number">1.1.</span> <span class="toc-text">SMB &#x2F; Samba</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%82%E5%9C%B0%E5%AE%B9%E7%81%BE"><span class="toc-number">1.2.</span> <span class="toc-text">异地容灾</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#smb-%E9%85%8D%E7%BD%AE"><span class="toc-number">2.</span> <span class="toc-text">SMB 配置</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#nas-%E7%AB%AF-45drive-s-file-sharing"><span class="toc-number">2.1.</span> <span class="toc-text">NAS 端 —— 45Drive’s File Sharing</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B6%E4%BB%96%E8%AE%BE%E5%A4%87%E7%AB%AF"><span class="toc-number">2.2.</span> <span class="toc-text">其他设备端</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#webdav"><span class="toc-number">3.</span> <span class="toc-text">WebDAV</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%87%AA%E5%BB%BA-webdav-%E6%9C%8D%E5%8A%A1"><span class="toc-number">3.1.</span> <span class="toc-text">自建 WebDAV 服务</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%91%E5%AE%9A%E6%8C%82%E8%BD%BD"><span class="toc-number">3.1.1.</span> <span class="toc-text">绑定挂载</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#caddy-webdav"><span class="toc-number">3.1.2.</span> <span class="toc-text">Caddy WebDAV</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%89%E8%A3%85-webdav-%E6%8F%92%E4%BB%B6"><span class="toc-number">3.1.2.1.</span> <span class="toc-text">安装 WebDAV 插件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#webdav-%E9%85%8D%E7%BD%AE"><span class="toc-number">3.1.2.2.</span> <span class="toc-text">WebDAV 配置</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#caddy-%E6%9D%83%E9%99%90%E9%85%8D%E7%BD%AE"><span class="toc-number">3.1.2.3.</span> <span class="toc-text">Caddy 权限配置</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#standalone-webdav-%E4%B8%8D%E6%8E%A8%E8%8D%90-%E5%9F%BA%E4%BA%8E-hacdias-webdav"><span class="toc-number">3.1.3.</span> <span class="toc-text">Standalone WebDAV（不推荐，基于 hacdias&#x2F;webdav）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#webdav-%E6%9C%8D%E5%8A%A1%E5%95%86"><span class="toc-number">3.2.</span> <span class="toc-text">WebDAV 服务商</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8C%82%E8%BD%BD-webdav-%E4%B8%BA%E6%9C%AC%E5%9C%B0%E7%A3%81%E7%9B%98"><span class="toc-number">3.3.</span> <span class="toc-text">挂载 WebDAV 为本地磁盘</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%8A%A8%E6%8C%82%E8%BD%BD"><span class="toc-number">3.3.1.</span> <span class="toc-text">自动挂载</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%91%BD%E4%BB%A4%E8%A1%8C%E6%89%8B%E5%8A%A8%E6%8C%82%E8%BD%BD-davfs2"><span class="toc-number">3.3.2.</span> <span class="toc-text">命令行手动挂载- davfs2</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%89%E8%A3%85"><span class="toc-number">3.3.2.1.</span> <span class="toc-text">安装</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8C%82%E8%BD%BD-webdav-%E7%A3%81%E7%9B%98"><span class="toc-number">3.3.2.2.</span> <span class="toc-text">挂载 WebDAV 磁盘</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8C%82%E8%BD%BD%E5%9D%9A%E6%9E%9C%E4%BA%91-webdav"><span class="toc-number">3.3.2.3.</span> <span class="toc-text">挂载坚果云 WebDAV</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BC%80%E6%9C%BA%E8%87%AA%E5%8A%A8%E6%8C%82%E8%BD%BD-webdav"><span class="toc-number">3.3.2.4.</span> <span class="toc-text">开机自动挂载 WebDAV</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%90%AF%E7%94%A8-davfs2-%E7%94%A8%E6%88%B7%E9%94%81"><span class="toc-number">3.3.2.4.1.</span> <span class="toc-text">启用 davfs2 用户锁</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%AE%B0%E4%BD%8F-webdav-%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81"><span class="toc-number">3.3.2.4.2.</span> <span class="toc-text">记住 WebDAV 账号密码</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%BC%80%E6%9C%BA%E6%89%A7%E8%A1%8C%E6%8C%82%E8%BD%BD"><span class="toc-number">3.3.2.4.3.</span> <span class="toc-text">开机执行挂载</span></a></li></ol></li></ol></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/NAS-1-1" title="NAS（1-1）—— 成品 NAS 配置（QNAP）"><img src="/assets/img/default.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="NAS（1-1）—— 成品 NAS 配置（QNAP）"/></a><div class="content"><a class="title" href="/NAS-1-1" title="NAS（1-1）—— 成品 NAS 配置（QNAP）">NAS（1-1）—— 成品 NAS 配置（QNAP）</a><time datetime="2025-08-17T14:46:10.000Z" title="发表于 2025-08-17 22:46:10">2025-08-17</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/uv" title="uv：新一代 Python 虚拟环境管理工具"><img src="/assets/img/default_cover4.JPG" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="uv：新一代 Python 虚拟环境管理工具"/></a><div class="content"><a class="title" href="/uv" title="uv：新一代 Python 虚拟环境管理工具">uv：新一代 Python 虚拟环境管理工具</a><time datetime="2025-07-15T08:04:27.000Z" title="发表于 2025-07-15 16:04:27">2025-07-15</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/nn-3" title="神经网络学习笔记（3）—— 激活函数"><img src="/assets/img/default_cover.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="神经网络学习笔记（3）—— 激活函数"/></a><div class="content"><a class="title" href="/nn-3" title="神经网络学习笔记（3）—— 激活函数">神经网络学习笔记（3）—— 激活函数</a><time datetime="2025-06-28T16:28:47.000Z" title="发表于 2025-06-29 00:28:47">2025-06-29</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/nn-2" title="神经网络学习笔记（2）—— 前向传播与反向传播的数学推导"><img src="/assets/img/kirby_cover16.JPG" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="神经网络学习笔记（2）—— 前向传播与反向传播的数学推导"/></a><div class="content"><a class="title" href="/nn-2" title="神经网络学习笔记（2）—— 前向传播与反向传播的数学推导">神经网络学习笔记（2）—— 前向传播与反向传播的数学推导</a><time datetime="2025-06-28T16:26:13.000Z" title="发表于 2025-06-29 00:26:13">2025-06-29</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/nn-1" title="神经网络学习笔记（1）—— MLP"><img src="/assets/img/kirby_cover19.JPG" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="神经网络学习笔记（1）—— MLP"/></a><div class="content"><a class="title" href="/nn-1" title="神经网络学习笔记（1）—— MLP">神经网络学习笔记（1）—— MLP</a><time datetime="2025-06-28T16:24:47.000Z" title="发表于 2025-06-29 00:24:47">2025-06-29</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2023 - 2025 By Dean Ma</span><span class="framework-info"><span>框架 </span><a target="_blank" rel="noopener external nofollow noreferrer" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.4.3</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="前往评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><div class="js-pjax"><script>(() => {
  const isShuoshuo = GLOBAL_CONFIG_SITE.pageType === 'shuoshuo'
  const option = null

  const getGiscusTheme = theme => theme === 'dark' ? 'dark' : 'light'

  const createScriptElement = config => {
    const ele = document.createElement('script')
    Object.entries(config).forEach(([key, value]) => {
      ele.setAttribute(key, value)
    })
    return ele
  }

  const loadGiscus = (el = document, key) => {
    const mappingConfig = isShuoshuo
      ? { 'data-mapping': 'specific', 'data-term': key }
      : { 'data-mapping': (option && option['data-mapping']) || 'pathname' }

    const giscusConfig = {
      src: 'https://giscus.app/client.js',
      'data-repo': 'Dawn1Ocean/giscus',
      'data-repo-id': 'R_kgDOLniK6Q',
      'data-category-id': 'DIC_kwDOLniK6c4CeVy2',
      'data-theme': getGiscusTheme(document.documentElement.getAttribute('data-theme')),
      'data-reactions-enabled': '1',
      crossorigin: 'anonymous',
      async: true,
      ...option,
      ...mappingConfig
    }

    const scriptElement = createScriptElement(giscusConfig)

    el.querySelector('#giscus-wrap').appendChild(scriptElement)

    if (isShuoshuo) {
      window.shuoshuoComment.destroyGiscus = () => {
        if (el.children.length) {
          el.innerHTML = ''
          el.classList.add('no-comment')
        }
      }
    }
  }

  const changeGiscusTheme = theme => {
    const iframe = document.querySelector('#giscus-wrap iframe')
    if (iframe) {
      const message = {
        giscus: {
          setConfig: {
            theme: getGiscusTheme(theme)
          }
        }
      }
      iframe.contentWindow.postMessage(message, 'https://giscus.app')
    }
  }

  btf.addGlobalFn('themeChange', changeGiscusTheme, 'giscus')

  if (isShuoshuo) {
    'Giscus' === 'Giscus'
      ? window.shuoshuoComment = { loadComment: loadGiscus }
      : window.loadOtherComment = loadGiscus
    return
  }

  if ('Giscus' === 'Giscus' || !true) {
    if (true) btf.loadComment(document.getElementById('giscus-wrap'), loadGiscus)
    else loadGiscus()
  } else {
    window.loadOtherComment = loadGiscus
  }
})()</script></div><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="true"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>